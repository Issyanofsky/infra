resource "aws_ecs_task_definition" "ec2_task_definition" {
  family                   = "${var.cluster_name}-ec2-task-definition"
  network_mode             = "bridge"
  execution_role_arn       = aws_iam_role.ecs_instance_role.arn
  task_role_arn            = aws_iam_role.ecs_instance_role.arn
  container_definitions    = jsonencode([{
    name      = "ec2-container"
    image     = var.container_image
    cpu       = 256
    memory    = 512
    essential = true
  }])
}

resource "aws_ecs_task_definition" "fargate_task_definition" {
  family                   = "${var.cluster_name}-fargate-task-definition"
  network_mode             = "awsvpc"
  execution_role_arn       = aws_iam_role.ecs_fargate_role.arn
  task_role_arn            = aws_iam_role.ecs_fargate_role.arn
  container_definitions    = jsonencode([{
    name      = "fargate-container"
    image     = var.container_image
    cpu       = 256
    memory    = 512
    essential = true
  }])
}
